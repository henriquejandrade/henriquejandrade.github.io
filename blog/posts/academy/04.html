---
layout: blog
parent: ../..
title: üíª Experimentos com cGAN
categories: blog, academy
description: "Blog de desenvoldimento para o mestrado"
keywords: deep learning, pix2pix, recife, machine learning, cgan, tradu√ß√£o de mapas
date: 05/25/2020
---

<div id="main-div">
    <p class="title">
        üíª Experimentos com cGAN
    </p>

    <p>
        Essa semana, testei a sugest√£o do meu professor, traduzir imagens do Recife de 2010 a 2015 usando o algoritmo
        <i>pix2pix</i>. Na hora de organizar os arquivos para treino e teste, acabei invertendo os conjuntos de imagem e
        testei a rede para traduzir 2015 em 2010. A implementa√ß√£o do algoritmo √© essa dispon√≠vel <a
            href="https://phillipi.github.io/pix2pix/">aqui</a>. Para esse treinamento, 150 itera√ß√µes foram executadas.
        Seguem os resultados:
    </p>

    <!-- Image -->
    <img class="illustration" src="images/04/01.jpg" />
    <p class="subtitle">As colunas da esquerda para a direita: imagem em 2010, imagem em 2015 e a previs√£o da rede.</p>

    <h3>Representa√ß√£o comum</h3>

    <p>
        Depois de analisar os resultados da tradu√ß√£o de imagem para imagem, percebi que a arquitetura da rede n√£o √©
        exatamente ideal para reproduzir a estrutura de uma imagem √© outra. A arquitetura consegue copiar o estilo e
        ilumina√ß√£o bem de uma imagem para outra, a rede tamb√©m manipula texturas bem. J√° a reprodu√ß√£o de disposi√ß√£o de
        elementos, elimina√ß√£o ou adi√ß√£o, quando a alimentamos com imagens no mesmo dom√≠nio do resultado esperado,
        torna-se dif√≠cil.
    </p>

    <p>
        Os exemplos do artigo s√£o claros: ou reproduzem mudan√ßas de textura e forma, ou traduzem <b>r√≥tulos</b>.
        Observando isso e a necessidade de haver uma tradu√ß√£o que n√£o dependa de um tempo hist√≥rico, tamb√©m considerando
        que n√£o haver√° fotografias de sat√©lite para todas as √©pocas, mas outras fontes de informa√ß√£o, precisei reavaliar
        a abstra√ß√£o "mapa". Tentei pensar um denominador comum a todos os mapas, uma representa√ß√£o √∫nica, a-hist√≥rica,
        que seja tamb√©m mais f√°cil de ser traduz√≠vel entre si. Seguindo o trabalho hist√≥rico-urban√≠stico de <a
            href="http://www.ceci-br.org/ceci/br/component/jcollection/item/28.html">Jos√© Luiz Mota Menezes</a> e a
        maioria dos exemplos do projeto <i>pix2pix</i>, resolvi representar os mapas e fotografias de sat√©lite atrav√©s
        de um <b>mapa de r√≥tulos</b>.
    </p>

    <p>
        Meu primeiro experimento foi rotular duas fotografias de sat√©lite, quebrar em peda√ßos e separar em grupos de
        treino e teste. As fotografias haviam sido utilizadas na tradu√ß√£o 2015-2010, ent√£o s√≥ precisei rotular e
        organizar as entradas. Seguem os mapas:
    </p>

    <!-- Image -->
    <img class="illustration" src="images/04/02.jpg" />
    <p class="subtitle">Bairros da Boa Vista, Santo Ant√¥nio, S√£o Jos√© e do Recife (2010)</p>
    </p>

    <!-- Image -->
    <img class="illustration" src="images/04/03.jpg" />
    <p class="subtitle">Seu mapa de r√≥tulos</p>
    </p>

    <!-- Image -->
    <img class="illustration" src="images/04/04.jpg" />
    <p class="subtitle">Corte da Avenida Agamenon Magalh√£es (2010)</p>
    </p>

    <!-- Image -->
    <img class="illustration" src="images/04/05.jpg" />
    <p class="subtitle">Seu mapa de r√≥tulos</p>

    <p>
        As cores indicam constru√ß√£o humana (laranja), parques ou √°reas verdes (verde), corpos de √°gua (azul), corredores
        vi√°rios (cinza) e pontes (vermelho). Os resultados foram visualmente melhores do que a tradu√ß√£o temporal:
    </p>

    <!-- Image -->
    <img class="illustration" src="images/04/06.jpg" />
    <p class="subtitle">A primeira linha de imagens mostra os recortes originais; a segunda linha mostra os r√≥tulos
        dados como entrada da rede; e na terceira, a previs√£o.</p>

    <p>
        Depois do modelo treinado, reconstrui as duas imagens usadas como um grande quebra-cabe√ßa:
    </p>

    <!-- Image -->
    <img class="illustration" src="images/04/07.jpg" />
    <p class="subtitle">Bairros da Boa Vista, Santo Ant√¥nio, S√£o Jos√© e do Recife (reconstru√≠do pela rede)</p>
    </p>

    <!-- Image -->
    <img class="illustration" src="images/04/08.jpg" />
    <p class="subtitle">Corte da Avenida Agamenon Magalh√£es (reconstru√≠do pela rede)</p>

    <h3>A import√¢ncia dos r√≥tulos</h3>

    <p>
        Porque eu n√£o tive o cuidado de rotular as casas como entes individuais, mas sim uma "massa" amontoada de
        constru√ß√µes, sem respeitar rigorosamente a divis√£o de blocos em todas as duas imagens, sem considerar os
        diferentes tipos de ocupa√ß√µes e suas densidades, eu diria que a reprodu√ß√£o das constru√ß√µes no resultado final
        foi o mais pobre dos r√≥tulos. Ao contr√°rio, os r√≥tulos utilizados na demarca√ß√£o de parques e √°reas verdes foram
        as que melhor tiveram desempenho em reproduzir at√© padr√µes exclusivos. O r√≥tulo para pontes, diria que o de mais
        detalhe, tamb√©m destacou-se na reprodu√ß√£o dos padr√µes visuais de sua categoria.
    </p>

    <h3>Tentativa do passado</h3>

    <p>
        Percebendo que a partir de um mapa de r√≥tulo era poss√≠vel reconstruir uma visualiza√ß√£o de sat√©lite com
        caracter√≠sticas interessantes, resgatei o mapa do Recife do ano de 1808, como visto no recorte abaixo:
    </p>

    <!-- Image -->
    <img class="illustration" src="images/04/09.jpg" />
    <p class="subtitle">Recorte do Porto do Plano e Pra√ßa de Pernambuco, por Joz√© Fernandes Portugal (1808)</p>

    <p>
        Escolhi esse recorte por ser uma √©poca da hist√≥ria onde uma configura√ß√£o urbana pr√≥xima a no√ß√£o contempor√¢nea j√°
        era presente e pelas nuances da regi√£o, presen√ßa dos r√≥tulos utilizados no treinamento anterior. Como entrada
        dessa rede, utilizei todos os mapas de r√≥tulo da tentativa anterior, ou seja, os dois mapas de 2010 e recortei o
        mapa de r√≥tulos de 1808, como visto abaixo:
    </p>

    <!-- Image -->
    <img class="illustration" src="images/04/10.jpg" />
    <p class="subtitle">Mapa de r√≥tulos do Recife 1808</p>

    <p>
        O treinamento levou 300 itera√ß√µes e apresentou resultados satisfat√≥rios diante da qualidade de r√≥tulos
        fornecidos:
    </p>

    <!-- Image -->
    <img class="illustration" src="images/04/11.png" />
    <p class="subtitle">A primeira coluna mostra alguns recortes do mapa e a segunda coluna o trabalho da rede</p>

    <p>
        A seguir √© poss√≠vel ver todas as imagens montando o panorama final:
    </p>

    <!-- Image -->
    <img class="illustration" src="images/04/12.jpg" />
    <p class="subtitle">Recorte do Porto do Plano e Pra√ßa de Pernambuco, por Joz√© Fernandes Portugal (reconstru√≠do pela
        rede)</p>

    <h3>E agora?</h3>

    <p>
        Como apontado, a qualidade dos r√≥tulos e as texturas utilizadas no treinamento significam bastante para o
        resultado da rede. Para os pr√≥ximos passos, pretendo testar melhores r√≥tulos e texturas, bem como outras
        arquiteturas e testes em tradu√ß√£o entre mapas de r√≥tulo.
    </p>

    <h3>Relacionado</h3>

    <div class="button" out-href="03">
        <img class="icon" src="../../../icons/things/paper.png" />
        <p>An√°lise do artigo "pix2pix"</p>
    </div>
</div>